<form id="contact-form">
  <div class="form-group">
    <label for="name">Name</label>
    <input type="text" id="name" name="name" required />
  </div>

  <div class="form-group">
    <label for="email">Email address</label>
    <input type="email" id="email" name="email" required />
  </div>

  <div class="form-group">
    <label for="message">Message to send</label>
    <textarea id="message" name="message" rows="5"></textarea>
  </div>
  <div class="form-group">
    <button type="submit" class="submit-button">Send message</button>
  </div>
</form>

<script>
  document
    .getElementById('contact-form')
    .addEventListener('submit', (event) => {
      event.preventDefault();

      const siteKey = '{{ .Site.Params.recaptcha.siteKey }}';
      const action = 'submit';

      grecaptcha.enterprise.ready(async () => {
        // get the token
        const token = await grecaptcha.enterprise.execute(siteKey, { action });

        // send the token to the backend for processing
        const url = '{{ .Site.Params.backend.baseUrl }}/contact-form';
        const response = await fetch(url, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            event: {
              token,
              action,
              siteKey,
            },
            payload: {
              name: document.getElementById('name').value,
              email: document.getElementById('email').value,
              message: document.getElementById('message').value,
            },
          }),
        });
      });
    });
</script>
